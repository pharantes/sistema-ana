"use client";

import { useSession, signOut } from "next-auth/react";
import { useRouter } from "next/navigation";
import { useEffect } from "react";
import DashboardClient from "./dashboard/DashboardClient";
import styled from 'styled-components';

const CenterFull = styled.div`
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
`;

const PagePad = styled.div`
  padding: var(--page-padding, 2rem);
`;

const ButtonPrimary = styled.button`
  height: var(--control-height, 36px);
  padding: 0 var(--space-md, var(--space-md, 16px));
  margin-right: var(--space-md, var(--space-md, 16px));
  background: #0070f3;
  color: white;
  border: none;
  border-radius: var(--radius-sm, var(--space-xxs, 4px));
  cursor: pointer;
`;

const ButtonDanger = styled.button`
  height: var(--control-height, 36px);
  padding: 0 var(--space-md, var(--space-md, 16px));
  background: #f56565;
  color: white;
  border: none;
  border-radius: var(--radius-sm, var(--space-xxs, 4px));
  cursor: pointer;
`;

const ButtonRow = styled.div`
  margin-top: var(--space-lg, 24px);
`;

export default function Home() {
  const { data: session, status } = useSession();
  const router = useRouter();

  useEffect(() => {
    if (status === "loading") return; // Still loading

    if (!session) {
      router.push("/login");
    }
  }, [session, status, router]);

  if (status === "loading") {
    return (
      <CenterFull>
        <div><Loading /></div>
      </CenterFull>
    );
  }

  return (
    <PagePad>
      <DashboardClient />
      <ButtonRow>
        <ButtonPrimary onClick={() => router.push("/acoes")}>Ir para Ações</ButtonPrimary>
        <ButtonDanger onClick={() => signOut({ callbackUrl: "/login" })}>Sair</ButtonDanger>
      </ButtonRow>
    </PagePad>
  );
}